import { Meta } from '@storybook/addon-docs/blocks'
import Logo from '@/assets/logo.png'
import { Ui } from '@you-eye/styled'

<Meta title="API Reference/useThing" />

# useThing


```js
const {
    error,
    isError,
    isLoading,
    isRefetching,
    isInitial,
    data,
    mappedData,
    reFetch,
    fetchMore,
    preFetch,
    canFetchMore
} = useThing(
    thingKey,
    fetchFn,
    {
        reducer,
        selector,
        initialData,
        getFetchMore,
        dataMapper,
        onStart,
        onSuccess,
        onError,
        skip,
        cache,
        options: externalOptions,
        reFetchOnWindowFocus,
        reFetchInterval,
        reFetchIntervalInBackground,
        ...extra
    }
)
```

## Options
* `thingKey: string` - entity key. Can be any string but usually we use something like ESomething, EWhatever, etc.
* `fetchFn: Function` - any promise which will return your data.
* `hookOptions: Object` - hook options.

### Hook options

* `reducer: Function` - classical redux reducer.
* `selector: Function` - selector to select data from the store.
* `initialData: Function | any` - if set, this value will be used as the initial data for the entity.
* `getFetchMore = () => boolean | object` function to generate fetch options to fetchMore function.
    * When new data is received for this entity, this function receives last options, last fetch result of the infinite list of data and the full array of all chunks.
    * Return `false` to indicate there is no next page available.
* `dataMapper: Function` - data mapper function. It will prepare your data before showing it somewhere. Use *mappedData* as a result of dataMapper.
* `skip: boolean`
    * Set this to **true** to disable this entity from automatically running.
    * Can be used for dependent entities.
* `cache: string`
    * 'no-cache' - try to fetch on the first usage of the hook.
    * 'cache-first' - get data from the cache and if there is not cache fetch it.
* `options: Record<string, unknown>` - will be passed into fetch, fetchMore, refetch  function and selector as a second argument. Here should be only data which can be serialized.
* `refetchOnWindowFocus: boolean` - If set to true, the thing will refetch on window focus if the data is stale.
* `refetchInterval: false | number` - If set to a number, all things will continuously refetch at this frequency in milliseconds.
* `reFetchIntervalInBackground: boolean` - If set to true, things that are set to continuously refetch with a refetchInterval will continue to refetch while their tab/window is in the background.
* `...extra: any` - anything you wanna pass to fetchFn.  Usually, it's some API client or something like that.

## Returns

* `isError: boolean` - has some errors or not.
* `isLoading: boolean` - true if the thing is currently fetching.
* `isRefetching: boolean` - true if the thing is currently refetching.
* `isInitial: boolean` - true if the data is in initial state.
* `data`
    * Defaults to `null`.
    * The last successfully resolved data for the entity.
* `mappedData: Record<string, unknown>` - prepared ( by dataMapper option ) data.
* `refetch: Function` - a function to manually refetch the thing.
* `fetchMore: Function` - a function to manually fetchMore the entity with additional request options. Example:
```js
fetchMore({ offset: 10, limit: 10 }).then(res => console.log)
// or
fetchMore()
```
* `preFetch: Function` - a function to manually prefetch the thing.
* `canFetchMore: boolean` - the result of getFetchMore function.